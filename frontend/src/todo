# ------------------------------------------------
# asap
# ------------------------------------------------

datetime ohne millisekunden anzeigen

VA-Liste
- alle Logo's holen und pflegen -> dann auch in Init-Skript schieben !
- View später mal ablösen (doch die irrelevanten auch markieren?)
- oben noch Filter für Jahr einbauen (Default = akt. Jahr) + Status switchen von Alle|beendet|aktiv|geplant + Kategorie switchen von EV|GV|AV
- make both tables look like separate cards (white background, grey surrounding)

Joe:
- compound key -> DELETE und UPDATE (PUT) geht nicht ?
- verisonierte Tabelle: anlegen eines früher bestehenden PK geht nicht z.B. nr 3 bei crud test
  - compound key hier auch noch testen

CRUD field validation before save (especially required fields) !

/api/crud/DWH.CONFIG.v_portal_veranstaltung?order_by=beginn_dt,ende_dt

        use dwh;

        drop view if exists config.v_portal_veranstaltung;
        create view config.v_portal_veranstaltung
        as
        select 
                vv.veranstaltung_nr 
                , vv.name 
                , vv.status
                , coalesce(vv.url, vr.url) as url
                , vv.jahr
                , vv.beginn_dt 
                , vv.ende_dt 
                , cast(DATEPART(dd, vv.beginn_dt) as varchar(2)) + '.' +  cast(DATEPART(mm, vv.beginn_dt) as varchar(2))
              + ' - ' +
              cast(DATEPART(dd, vv.ende_dt) as varchar(2)) + '.' +  cast(DATEPART(mm, vv.ende_dt) as varchar(2)) + '.' +  cast(DATEPART(yyyy, vv.ende_dt) as varchar(4))
              as zeitraum
            , vr.logo as logo_url
          from dwh.core.vv_veranstaltung vv 
              left outer join dwh.core.vv_veranstaltungsreihe vr on vv.veranstaltungsreihe_id = vr.veranstaltungsreihe_id 
          where 1=1
          and vv.jahr = 2023
          and vv.veranstaltung_nr not like '%9999%'
          and lower(vv.name) not like '%complimentary%'
          and lower(vv.name) not like '%servicepartner%'
          and vv.ist_terminal = 'N'
          ;


crud ui textarea components
  - Settings.js -> switch back to textarea_sql (lookup) and textarea_json (application) -> state gets lost ?!
  - sql: formatter and validator !
  - json:
    - textarea_json (with formatter and validator)
    - https://sujinleeme.github.io/react-json-editor/ + json schema !
  - monaco-editor evtl. switchen auf https://wangchujiang.com/react-monacoeditor/ ?
  - markdown: erweitern um "remark-gfm"

finish dark mode switch
- put it in user profile page or as menu option when clicking on avatar in upper right corner
- make 3 options: yes / no / browser default
- save setting in repository (table: user_preference)

auf "errors" im body reagieren !



# ------------------------------------------------
# wait for backend
# ------------------------------------------------

API enhancements:
  - Excel
    - Sheetname: "daten"
      - Headerzeile: Arial, 9, Border unten, Auto filter, Bold, Left (align)
      - Datensätze: Arial, 9
    - zusätzliches Sheet "info"
          Erstellt am: <YYYY-MM-DD HH24:MI:SS>
          Quelle: DWH - Adhoc <nr>
  - Security / Auth-API / JWT Token
    - use JWT (JWT Extended or Praetorian)
    - combine with login.js frontend 
    - if possible get JWT in session -> test this with Cube.js :)
    - integrated Users and Roles
      - Admin: Zugriff auf Settings-Icon + App-Icon in Header, Editierbutton bei Adhocliste in Portal (Route /)
      - User
    - fill last_changed_by !
  - swagger-UI
  - Fehlermeldungen als JSON zurückgeben (timestamp, error(s), message(s), detail(s)) (https://www.baeldung.com/rest-api-error-handling-best-practices)
    - get error from API and show it (e.g. wrong datatype, primary key already exists, etc.)


bundle and run first version on DEV server
  - use flask as webserver ? how to replace "proxy" setting ?
  - make customer CI settings (logo, title, etc.)



# ------------------------------------------------
# Backlog
# ------------------------------------------------

- getLookups() in CRUDApp.js werden nicht refreshed bei Page-Switch / Dialog-Schliessung / etc.
- AppRuntime: auch pagination einbauen, sowie Suche/Filter
- add "page" and "file" as resource for documentation, blog, etc.
  page: id, name, alias, parent_page_id, content_as_markdown
  file: id, name, mime_type, content_as_binary
- then add UI for pages and file management (list, update, delete, add)
- Applikationsmetadaten werden bei Repo Init nicht geladen (Fehler) - Adhoc + ext. Ressourcen
- alle API Aufrufe kapseln !! (vor allem das getLookup... Konstrukt zum Austauschen von Lookup-IDs mit Werten in Tables nochmal schöner schreiben)
- Warning: Each child in a list should have a unique "key" prop.
- Security:
  - external Users / Anbindung an AD !
  - SSO
- Swagger UI:
  - https://sean-bradley.medium.com/add-swagger-ui-to-your-python-flask-api-683bfbb32b36
  - https://towardsdatascience.com/working-with-apis-using-flask-flask-restplus-and-swagger-ui-7cf447deda7f
- Datentyp "bit" kann angelegt/editiert werden, aber in der "Table" wird nichts angezeigt (hier kann wohl der Wert true/false nicht interpretiert werden)
- Formitem "email" aktuell identisch zu Textinput -> erweitern um E-mail Validierung
- Tables: Data formats: "datetime" anzeigen ohne Uhrzeit und Millisekunden ?! -> Format angeben in Spezifikation ?
- Tables: Sorting -> show sorted fields with closable tags with icon (asc./desc.) (e.g. "Sortiert nach <Tag1 (auf.)> <Tag2 (ab.)>" - also add "x" button to delete all sorters
- Tables: Filtering
- Tables: Search
- Tables: Pagination
- Apps: Switch einbauen von "Cards" zu "List"
- Home: übergreifende Suche (search bar)
- Home: Filter switchen zwischen "Daten", "Typ"
- Gesamtanzahl Datensätze bei Adhoc anzeigen
- bei Applikations-Spezifikation eine Hilfe einbauen (z.B. Infobutton oder Doku), auch eine Verifiziuerng der Spezifikation, ob sie valide ist.
- bei Modal die Höhe/Breite besser ausnutzen, vor allem bei Textarea's (SQL/JSON/...)
- schöne Spaltennamen bei Adhoc's erlauben?
- "Typ" bei externen Ressourcen vorgeben ? (damit Icon dann auch immer passt)
- Adhoc + ext. Ressource doch in /settings schieben ?
- Fehlerhandling übergreifend konzipieren und umsetzen
- Navbar:   https://medium.com/zestgeek/ant-design-navbar-with-responsive-drawer-a8d718e471e0
- Datenquellenattribut (plainbi_datasource) not used yet in python backend (still in .env file) - datasource_id -> use it everywhere ?!


# ------------------------------------------------
# Backlog (priority low)
# ------------------------------------------------

Apps create/edit dialog:
  - "copy to clipboard" not working ?!
  - add rule to "url": no blanks, no special characters
  - if param "id" is missing -> then mode=create, else mode=edit
      mode=create: no "delete" button
      mode=edit: get metadata of app and fill the form
  - "editing of columns" is missing right now
  - redesign the page UI
